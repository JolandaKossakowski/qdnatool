---
title: "ecdf_histogram"
author: "Jolanda J. Kossakowski, BSc"
date: "13 August 2015"
output: html_document
---


```{r, message=FALSE}
setwd("~/Documents/PhD/Projects/qDNA")
load("Markdown test.RData")

library(ggplot2)

totaal <- rowSums(input.correct)
heights <- length(totaal)
h = heights[1]

n <- sort(unique(totaal))

for(i in 1:length(n))
{
  h = h - length(totaal[totaal == n[i]])
  heights = c(heights, h)
}

cesuurlijnen <- seq(0.2, 0.8, 0.2) * nrow(input.correct)
gridlijnen <- round(seq(0, nrow(input.correct), (nrow(input.correct)/25)), 0)

gridlijnen <- gridlijnen[-grep(paste(cesuurlijnen, collapse = "|"), gridlijnen)]

heights <- heights[1:length(unique(totaal))]
percent <- heights/length(totaal)*100
df <- data.frame(score = sort(unique(totaal)), total = heights, percent = round(percent,2))

h <- ggplot(data = df, aes(x = score, y = total)) + 
    geom_hline(yintercept = c(gridlijnen), linetype = "solid", colour = "gray80") +  
  geom_hline(yintercept = cesuurlijnen, linetype = "dashed", size = 0.75, colour = "black") +
  geom_histogram(stat = "identity", binwidth = 1) + 
  xlab("Totaal score") + ylab("% studenten dat score of hoger heeft") + 
  scale_y_continuous(breaks = c(0, cesuurlijnen, nrow(input.correct)), labels = c(seq(0, 100, 20))) +
  scale_x_continuous(limits = c(0, ncol(input.correct)), breaks = 1:ncol(input.correct)) + 
  theme_bw() +
  theme(panel.grid = element_blank())

print(h)
```