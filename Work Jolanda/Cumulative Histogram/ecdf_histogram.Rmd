---
title: "ecdf_histogram"
author: "Jolanda J. Kossakowski, BSc"
date: "13 August 2015"
output: html_document
---


```{r, message=FALSE}
setwd("~/Documents/UvA/qDNA")
load("Markdown test.RData")

library(ggplot2)

totaal <- rowSums(input.correct)
heights <- length(totaal)
h = heights[1]

n <- sort(unique(totaal))

for(i in 1:length(n))
{
  h = h - length(totaal[totaal == n[i]])
  heights = c(heights, h)
}

heights <- heights[1:length(unique(totaal))]
percent <- heights/length(totaal)*100
df <- data.frame(score = as.factor(sort(unique(totaal))), total = heights, percent = round(percent,2))

h <- ggplot(data = df, aes(x = score, y = total)) + geom_histogram(stat = "identity", binwidth = 1) + xlab("Totaal score") + ylab("% studenten dat score of hoger heeft") + geom_text(aes(label= paste(percent, "%", sep = "")), position=position_dodge(width=0.9), vjust=-0.25) 

print(h)
```